var timer,timeOut_Val=300,timeOut=timeOut_Val,preview_shortcode=jQuery(".wprpsp-customizer").attr("data-shortcode"),dep_wrap=".wprpsp-customizer-control",dependency=jQuery(dep_wrap+" .wprpsp-cust-dependency").attr("data-dependency");function wprpsp_generate_shortcode_preview(){var o="",e=jQuery(".wprpsp-customizer"),p=jQuery(".wprpsp-customizer-control"),r=preview_shortcode;clearTimeout(timer),timer=setTimeout(function(){e.find(".wprpsp-customizer-loader").fadeIn(),o+="["+r,p.find('input[type="text"], input[type="checkbox"]:checked, input[type="radio"], input[type="number"], textarea, select').each(function(e,p){if(!jQuery(this).hasClass("wprpsp-cust-hidden-field")){var r=jQuery(this).val(),t=jQuery(this).attr("name"),s=jQuery(this).attr("data-default"),i=jQuery(this).attr("data-empty");void 0===r||""==r&&!i||r==s||(o+=" "+t+'="'+r+'"')}}),o+="]",e.find(".wprpsp-customizer-shrt").val(o),jQuery("#wprpsp-customizer-shrt-form").submit(),e.find(".wprpsp-customizer-preview-frame").load(function(){e.find(".wprpsp-customizer-loader").fadeOut()})},timeOut)}function wprpsp_check_ref_dependency(r){if(ref_dep=r in dependency,ref_dep){var t=jQuery(dep_wrap+" .wprpsp-"+r).val();jQuery.each(dependency[r].show,function(e,p){jQuery(dep_wrap+" .wprpsp-"+e).closest(".wprpsp-customizer-row").hide(),jQuery(dep_wrap+" .wprpsp-"+e).addClass("wprpsp-cust-hidden-field"),-1!==jQuery.inArray(t,p)&&jQuery(dep_wrap+" .wprpsp-"+r).is(":visible")&&(jQuery(dep_wrap+" .wprpsp-"+e).closest(".wprpsp-customizer-row").show(),jQuery(dep_wrap+" .wprpsp-"+e).removeClass("wprpsp-cust-hidden-field")),wprpsp_check_ref_dependency(e)})}}dependency=jQuery.parseJSON(dependency),jQuery(document).ready(function(i){i(document).on("click",".wprpsp-cust-dwp",function(){i("body").toggleClass("wprpsp-cust-full-preview"),i(this).toggleClass("wprpsp-cust-dwp-active")}),i("#wprpsp-cust-accordion").accordion({collapsible:!0,heightStyle:"content",icons:{header:"dashicons dashicons-arrow-down-alt2",activeHeader:"dashicons dashicons-arrow-up-alt2"}}),0<i(".wprpsp-cust-color-box").length&&i(".wprpsp-cust-color-box").wpColorPicker({change:function(e,p){wprpsp_generate_shortcode_preview()},clear:function(){wprpsp_generate_shortcode_preview()}}),i(document).on("change",'.wprpsp-customizer-control select, .wprpsp-customizer-control input[type="number"], .wprpsp-customizer-control .wprpsp-color-box',function(){field_timeout=i(this).attr("data-timeout"),timeOut="undefined"!=typeof field_timeout?field_timeout:timeOut_Val,wprpsp_generate_shortcode_preview()}),i(document).on("keyup",'.wprpsp-customizer-control input[type="text"], .wprpsp-customizer-control input[type="number"]',function(){field_timeout=i(this).attr("data-timeout"),timeOut="undefined"!=typeof field_timeout?field_timeout:timeOut_Val,wprpsp_generate_shortcode_preview()}),i(document).on("change",".wprpsp-cust-shrt-switcher",function(){redirect=i(this).find(":selected").attr("data-url"),"undefined"!=typeof redirect&&""!=redirect&&(window.location=redirect)}),jQuery("#wprpsp-customizer-shrt-form").submit(function(e){var p=i(this).attr("target");if(void 0===p||""==p)return!1}),i(document).on("click",".wprpsp-cust-shrt-generate",function(){var e=i.trim(i(".wprpsp-customizer-shrt").val()),p=e.substr(0,1),r=e.substr(-1);if(""==e)return!1;"["==p&&"]"==r&&(p=(e=i.trim(e.slice(1,-1))).substr(0,1),r=e.substr(-1)),"["!=p&&(e="["+e),"]"!=r&&(e+="]"),i(".wprpsp-customizer-shrt").val(e),temp_shrt_val=i.trim(e.slice(1,-1));var t=wp.shortcode.attrs(temp_shrt_val);if(t.numeric[0]&&t.numeric[0]!==preview_shortcode)return alert(Wprpsp_Shrt_Mapper.shortocde_err),!1;t.named&&i.each(t.named,function(e,p){e&&i(".wprpsp-customizer-control .wprpsp-"+e).val(p).trigger("change").trigger("keyup")})}),dependency?i.each(dependency,function(e,p){e&&(setTimeout(function(){i(dep_wrap+" .wprpsp-"+e).trigger("change")},10),i(document).on("change keyup",dep_wrap+" .wprpsp-"+e,function(){var s=i(this).val();p.show&&i.each(p.show,function(e,p){i(dep_wrap+" .wprpsp-"+e).closest(".wprpsp-customizer-row").hide(),i(dep_wrap+" .wprpsp-"+e).addClass("wprpsp-cust-hidden-field"),-1!==i.inArray(s,p)&&(i(dep_wrap+" .wprpsp-"+e).closest(".wprpsp-customizer-row").show(),i(dep_wrap+" .wprpsp-"+e).removeClass("wprpsp-cust-hidden-field")),wprpsp_check_ref_dependency(e)}),p.hide&&i.each(p.hide,function(r,e){if(i(dep_wrap+" .wprpsp-"+r).closest(".wprpsp-customizer-row").show(),i(dep_wrap+" .wprpsp-"+r).removeClass("wprpsp-cust-hidden-field"),-1!==i.inArray(s,e)&&(i(dep_wrap+" .wprpsp-"+r).closest(".wprpsp-customizer-row").hide(),i(dep_wrap+" .wprpsp-"+r).addClass("wprpsp-cust-hidden-field")),ref_dep=r in dependency,ref_dep){var t=i(dep_wrap+" .wprpsp-"+r).val();i.each(dependency[r].hide,function(e,p){i(dep_wrap+" .wprpsp-"+e).closest(".wprpsp-customizer-row").hide(),i(dep_wrap+" .wprpsp-"+e).addClass("wprpsp-cust-hidden-field"),-1!=i.inArray(t,p)||i(dep_wrap+" .wprpsp-"+r).hasClass("wprpsp-cust-hidden-field")||(i(dep_wrap+" .wprpsp-"+e).closest(".wprpsp-customizer-row").show(),i(dep_wrap+" .wprpsp-"+e).removeClass("wprpsp-cust-hidden-field"))})}})}))}):wprpsp_generate_shortcode_preview()});